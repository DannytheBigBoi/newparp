{% extends "rp/base.html" %}
{% block title%}{% if type == None: %}Your{% else %}{{type|capitalize}}{% endif %} Chats â€“ Charat RP{% endblock %}
{% block header %}
<script>var logged_in={{'true' if logged_in else 'false'}};</script>
<link rel="stylesheet" media="screen" type="text/css" href="{{url_for("static", filename="css/rp/home.css")}}" />
<link rel="stylesheet" media="screen" type="text/css" href="{{url_for("static", filename="css/rp/front.css")}}" />
<style>
.section .section {
    margin: 0;
}

.card .chat-types {
    display: inline-block;
    font-size: 16px;
}

.card.chat a.title {
    display: block;
    font-size: 20px;
    text-align: center;
}

.card.chat .topic {
    font-size: 16px;
}
</style>
{% endblock %}

{% block content %}

<div id="topbar">
    <div id="toptitle">Charat RP</div>
    <div id="topmenu">
        <div class="topborder"></div>
        <a id="goHome" href="{{url_for('home')}}">Home</a>
        <div class="topborder"></div>
        <a id="goHome" href="{{url_for('rp_home')}}">RP Home</a>
        <div class="topborder"></div>
        <a id="goChats" href="{{url_for('chat_list')}}">Chats</a>
        <div class="topborder"></div>
        <a id="goUser" href="">Guide</a>
        <div class="topborder"></div>
        <a id="goUser" href="">Settings</a>
        <div class="topborder"></div>
        {% if logged_in %}
        <a class="logout" href="{{url_for("logout")}}">Logout</a>
        {% else %}
        <a class="login" href="">Login</a>
        {% endif %}
    </div>
</div>

<div class="body">
    <!-- Put in some noscript things -->
    <div id="chat-options" class="section">
        <div class="titli">{% if type == None: %}CHATS{% else %}{{type|upper}} CHATS{% endif %}</div>
        <div class="section">
            <div class="card">
                {% block pager %}
                {% if paginator.page_count!=1 %}
                <div class="pager">
                {{paginator.pager(format='~5~')}}
                </div>
                {% endif %}
                {% endblock %}
                
                {% for key in chat_classes|sort: %}
                    {% if type == key: %}
                        {% if key == 'pm': %}
                            <div class="chat-types">Private</div>
                        {% elif key == None: %}
                            <div class="chat-types">All</div>
                        {% else %}
                            <div class="chat-types">{{key|capitalize}}</div>
                        {% endif %}
                    {% else %}
                        {% if key == 'pm': %}
                            <div class="chat-types"><a href="{{url_for('chat_list', type='pm')}}">Private</a></div>
                        {% elif key == None: %}
                            <div class="chat-types"><a href="{{url_for('chat_list')}}">All</a></div>
                        {% else %}
                            <div class="chat-types"><a href="{{url_for('chat_list', type=key)}}">{{key|capitalize}}</a></div>
                        {% endif %}
                    {% endif %}
                {% endfor %}
    
                {{ self.pager() }}
            </div>
        </div>
        <div class="section">
            {% for i in range(0,chats|length,3): %}
            {% set chat = chats[i][0] %}
            {% set users_online = chats[i][1] %}
            <div class="card chat">
                <a id="chat-{{chat.url}}" class="title" href="{{url_for('chat', url=chat.url)}}">{{chat.title}}{% if chat.unread: %} (unread){% endif %}</a>({{users_online}} online)
                {% if chat.type == 'group' %}<div class="topic">{{chat.topic}}</div>{% endif %}
            </div>
            {% endfor %}
        </div>
        <div class="section">
            {% for i in range(1,chats|length,3): %}
            {% set chat = chats[i][0] %}
            {% set users_online = chats[i][1] %}
            <div class="card chat">
                <a id="chat-{{chat.url}}" class="title" href="{{url_for('chat', url=chat.url)}}">{{chat.title}}{% if chat.unread: %} (unread){% endif %}</a>({{users_online}} online)
                {% if chat.type == 'group' %}<div class="topic">{{chat.topic}}</div>{% endif %}
            </div>
            {% endfor %}
        </div>
        <div class="section">
            {% for i in range(2,chats|length,3): %}
            {% set chat = chats[i][0] %}
            {% set users_online = chats[i][1] %}
            <div class="card chat">
                <a id="chat-{{chat.url}}" class="title" href="{{url_for('chat', url=chat.url)}}">{{chat.title}}{% if chat.unread: %} (unread){% endif %}</a>({{users_online}} online)
                {% if chat.type == 'group' %}<div class="topic">{{chat.topic}}</div>{% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}